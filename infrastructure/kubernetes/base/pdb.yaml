# Pod Disruption Budgets
# NOTE: PDBs with minAvailable >= replicas will block voluntary disruptions
# For single-pod deployments, we use maxUnavailable: 1 instead

# Backend PDB - Allows maintenance operations
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: backend-pdb
  labels:
    app: backend
spec:
  # For single pod: allow disruption (node drain, etc.)
  # Change to minAvailable: 1 when scaling to 2+ pods
  maxUnavailable: 1
  selector:
    matchLabels:
      app: backend
---
# Frontend PDB - Allows maintenance operations
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: frontend-pdb
  labels:
    app: frontend
spec:
  maxUnavailable: 1
  selector:
    matchLabels:
      app: frontend
---
# Redis PDB - Critical for data consistency
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: redis-pdb
  labels:
    app: redis
spec:
  # Redis should drain gracefully - allow disruption
  maxUnavailable: 1
  selector:
    matchLabels:
      app: redis
